<!-- $Header: /var/lib/cvs/pgsql-fr/sgml/ref/set_transaction.sgml,v 1.10 2005/04/22 06:38:58 guillaume Exp $ -->
<refentry id="SQL-SET-TRANSACTION">
 <refmeta>
  <refentrytitle id="SQL-SET-TRANSACTION-TITLE">SET TRANSACTION</refentrytitle>
  <refmiscinfo>SQL - Instructions du langage</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>SET TRANSACTION</refname>
  <refpurpose>initialise les caractéristiques de la transaction
   actuelle</refpurpose>
 </refnamediv>

 <indexterm zone="sql-set-transaction">
  <primary>SET TRANSACTION</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
SET TRANSACTION <replaceable class="parameter">mode_transaction</replaceable> [, ...]
SET SESSION CHARACTERISTICS AS TRANSACTION <replaceable class="parameter">mode_transaction</replaceable> [, ...]

où <replaceable class="parameter">mode_transaction</replaceable> fait partie
de&nbsp;:

    ISOLATION LEVEL { SERIALIZABLE | REPEATABLE READ | READ COMMITTED | READ UNCOMMITTED }
    READ WRITE | READ ONLY
</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>

  <para>
   La commande <command>SET TRANSACTION</command> initialise les
   caractéristiques de la transaction actuelle. Il n'a aucun effet sur les
   transactions suivantes. <command>SET SESSION CHARACTERISTICS</command>
   initialise les caractéristiques de transaction par défaut pour les prochaines
   transactions d'une session. Ces valeurs peuvent être surchargées
   par <command>SET TRANSACTION</command> pour une transaction individuelle.
  </para>

  <para>
   Les caractéristiques disponibles de la transaction sont le niveau
   d'isolation de la transaction et le mode d'accès de la transaction
   (lecture/écriture ou lecture seule).
  </para>

  <para>
   Le niveau d'isolation d'une transaction détermine les données que la
   transaction peut voir quand d'autres transactions fonctionnent en même
   temps&nbsp;:

   <variablelist>
    <varlistentry>
     <term><literal>READ COMMITTED</literal></term>
     <listitem>
      <para>
       Une instruction peut seulement voir les lignes validées avant qu'elle ne
       commence. C'est la valeur par défaut.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><literal>SERIALIZABLE</literal></term>
     <listitem>
      <para>
       Toutes les instructions de la transaction en cours peuvent seulement voir
       les lignes validées avant que la première requête ou la première
       instruction de modification de données ait été exécutée dans cette
       transaction.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>

   Le standard SQL définit deux niveaux supplémentaires, <literal>READ
   UNCOMMITTED</literal> et <literal>REPEATABLE READ</literal>.
   Dans <productname>PostgreSQL</productname>, <literal>READ
   UNCOMMITTED</literal> est traité comme
   <literal>READ COMMITTED</literal> alors que <literal>REPEATABLE
   READ</literal> est traité comme <literal>SERIALIZABLE</literal>.
  </para>

  <para>
   Le niveau d'isolation de la transaction ne peut pas être modifié après que
   la première requête ou la première instruction de modification de données
   (<command>SELECT</command>, <command>INSERT</command>,
   <command>DELETE</command>, <command>UPDATE</command>,
   <command>FETCH</command> ou <command>COPY</command>) d'une transaction ait
   été exécutée. Voir <xref linkend="mvcc"> pour plus d'informations sur
   l'isolation de la transaction et le contrôle de concurrence.
  </para>

  <para>
   Le mode d'accès de la transaction détermine si la transaction est en
   lecture/écriture ou en lecture seule. Lecture/écriture est la valeur par
   défaut. Quand une transaction est en lecture seule, les commandes SQL
   suivantes sont interdites&nbsp;: <literal>INSERT</literal>,
   <literal>UPDATE</literal>, <literal>DELETE</literal> et <literal>COPY
   FROM</literal> si la table qu'elles modifieraient n'est pas une table
   temporaire&nbsp;; toutes les commandes <literal>CREATE</literal>,
   <literal>ALTER</literal> et <literal>DROP</literal>&nbsp;;
   <literal>COMMENT</literal>, <literal>GRANT</literal>,
   <literal>REVOKE</literal>, <literal>TRUNCATE</literal>&nbsp;;
   <literal>EXPLAIN ANALYZE</literal> et <literal>EXECUTE</literal> si la
   commande qu'ils exécuteraient est parmi celles listées. Ceci est une notion
   de haut niveau de lecture seule qui n'empêche pas toutes les écritures sur
   disque.
  </para>
 </refsect1>

 <refsect1>
  <title>Notes</title>

  <para>
   Si <command>SET TRANSACTION</command> est exécuté sans un
   <command>START TRANSACTION</command> ou un <command>BEGIN</command> le
   précédant, il est sans effet car la transaction se termine immédiatement.
  </para>

  <para>
   Il est possible de compenser <command>SET TRANSACTION</command> en
   spécifiant le <replaceable class="parameter">mode_transaction</replaceable>
   désiré dans <command>BEGIN</command> ou <command>START TRANSACTION</command>.
  </para>

  <para>
   Les modes de transaction par défaut d'une session peuvent aussi être
   configurés en initialisant les paramètres de configuration <xref
   linkend="guc-default-transaction-isolation"> et <xref
   linkend="guc-default-transaction-read-only">. (En fait, <command>SET SESSION
   CHARACTERISTICS</command> est un équivalent verbeux de la configuration de
   ces variables avec <command>SET</>.) Ceci signifie que les valeurs par défaut
   peuvent être initialisées dans le fichier de configuration, via
   <command>ALTER DATABASE</>, etc.  Consultez <xref linkend="runtime-config">
   pour plus d'informations.
  </para>
 </refsect1>

 <refsect1 id="R1-SQL-SET-TRANSACTION-3">
  <title>Compatibilité</title>

  <para>
   Les deux commandes sont définies dans le standard <acronym>SQL</acronym>.
   <literal>SERIALIZABLE</literal> est le niveau d'isolation par défaut de la
   transaction dans le standard. Dans
   <productname>PostgreSQL</productname>, la valeur par défaut est
   habituellement <literal>READ COMMITTED</literal>, mais vous pouvez la
   modifier comme mentionné ci-dessus. À cause d'un manque de verrou du
   prédicat, le niveau <literal>SERIALIZABLE</literal> n'est pas vraiment
   sérialisable. Voir <xref linkend="mvcc"> pour plus de détails.
  </para>

  <para>
   Dans le standard SQL, il existe une autre caractéristique de transaction
   pouvant être configurée avec ces commandes&nbsp;: la taille de l'aire de
   diagnostique. Ce concept est seulement à utiliser en SQL embarqué et, du
   coup, n'est pas implémenté dans le serveur
   <productname>PostgreSQL</productname>.
  </para>

  <para>
   Le standard SQL requiert des virgules entre chaque <replaceable
   class="parameter">mode_transaction</replaceable> mais, pour des raisons
   historiques, <productname>PostgreSQL</productname> autorise l'omission des
   virgules.
  </para>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode:sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:("/usr/lib/sgml/catalog")
sgml-local-ecat-files:nil
End:
-->
