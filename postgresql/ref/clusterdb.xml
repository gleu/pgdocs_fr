<?xml version="1.0" encoding="UTF-8"?>
<!-- Dernière modification
     le       $Date$
     par      $Author$
     révision $Revision$ -->
<!-- SAS 20060616 -->

<refentry id="app-clusterdb">
 <refmeta>
  <refentrytitle><application>clusterdb</application></refentrytitle>
  <manvolnum>1</manvolnum>
  <refmiscinfo>Application</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname id="clusterdb">clusterdb</refname>
  <refpurpose>Grouper une base de données
   <productname>PostgreSQL</productname></refpurpose>
 </refnamediv>

 <refsynopsisdiv>
  <cmdsynopsis>
   <command>clusterdb</command>
   <arg rep="repeat"><replaceable>connection-option</replaceable></arg>
   <group choice="opt"><arg choice="plain"><option>--verbose</option></arg><arg choice="plain"><option>-v</option></arg></group>
   <arg choice="opt"><group choice="plain"><arg choice="plain"><option>--table</option></arg><arg choice="plain"><option>-t</option></arg></group> <replaceable>table</replaceable> </arg>
   <arg choice="opt"><replaceable>nom_base</replaceable></arg>
  </cmdsynopsis>

  <cmdsynopsis>
   <command>clusterdb</command>
   <arg rep="repeat"><replaceable>connection-option</replaceable></arg>
   <group choice="opt"><arg choice="plain"><option>--verbose</option></arg><arg choice="plain"><option>-v</option></arg></group>
   <group choice="plain"><arg choice="plain"><option>--all</option></arg><arg choice="plain"><option>-a</option></arg></group>
  </cmdsynopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>
  <indexterm zone="app-clusterdb">
   <primary>clusterdb</primary>
  </indexterm>

  <para>
   <application>clusterdb</application> est un outil de regroupage
   de tables au sein d'une base de données <productname>PostgreSQL</productname>.
   Il trouve les
   tables précédemment groupées et les groupe à nouveau sur
   l'index utilisé lors du groupement initial. Les tables qui n'ont jamais
   été groupées ne sont pas affectées.
  </para>

  <para>
   <application>clusterdb</application> est un enrobage de la commande
   SQL <xref linkend="sql-cluster"/>. Il n'y a pas
   de différence réelle entre le groupage de bases par cet outil ou par
   d'autres méthodes d'accès au serveur.
  </para>

 </refsect1>


 <refsect1>
  <title>Options</title>

   <para>
    <application>clusterdb</application> accepte les arguments suivants en
    ligne de commande&nbsp;:
    
    <variablelist>
     <varlistentry>
      <term><option>-a</option></term>
      <term><option>--all</option></term>
      <listitem>
       <para>
		Grouper toutes les bases de données.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option><optional>-d</optional> <replaceable class="parameter">nom_base</replaceable></option></term>
      <term><option><optional>--nombase=</optional><replaceable class="parameter">nom_base</replaceable></option></term>
      <listitem>
       <para>
		Le nom de la base de données à grouper. Si ni ce nom, ni
		l'option <option>-a</option> (ou <option>--all</option>) ne sont précisés,
		le nom de la base de données est lu à partir de la variable
		d'environnement <envar>PGDATABASE</envar>. Si cette dernière n'est pas initialisée,
		le nom de l'utilisateur spécifié pour la connexion est utilisé.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-e</option></term>
      <term><option>--echo</option></term>
      <listitem>
       <para>
        Les commandes engendrées par <application>clusterdb</application>
		et envoyées au serveur sont affichées.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-q</option></term>
      <term><option>--quiet</option></term>
      <listitem>
       <para>
        Aucun message de progression n'est affiché.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-t <replaceable class="parameter">table</replaceable></option></term>
      <term><option>--table=<replaceable class="parameter">table</replaceable></option></term>
      <listitem>
       <para>
		Seule la table <replaceable class="parameter">table</replaceable> est groupée.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-v</option></term>
      <term><option>--verbose</option></term>
      <listitem>
       <para>
        Affiche des informations détaillées lors du traitement.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
       <term><option>-V</option></term>
       <term><option>--version</option></term>
       <listitem>
       <para>
         Affiche la version de <application>clusterdb</application> puis
         quitte.
       </para>
       </listitem>
     </varlistentry>

    <varlistentry>
      <term><option>-?</option></term>
      <term><option>--help</option></term>
      <listitem>
      <para>
        Affiche l'aide sur les arguments en ligne de commande de
        <application>clusterdb</application>, puis quitte
      </para>
      </listitem>
    </varlistentry>

    </variablelist>
   </para>

   <para>
    <application>clusterdb</application> accepte aussi les arguments suivants en
    ligne de commande pour les paramètres de connexion&nbsp;:
    
   <variablelist>
     <varlistentry>
      <term><option>-h <replaceable class="parameter">hôte</replaceable></option></term>
      <term><option>--host <replaceable class="parameter">hôte</replaceable></option></term>
      <listitem>
       <para>
		Le nom de la machine hôte sur laquelle le serveur
        fonctionne. Si la valeur commence par une barre oblique (slash), elle est utilisée comme
        répertoire du socket de domaine Unix.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-p <replaceable class="parameter">port</replaceable></option></term>
      <term><option>--port=<replaceable class="parameter">port</replaceable></option></term>
      <listitem>
       <para>
		Le port TCP ou l'extension du fichier du socket local de
        domaine Unix sur lequel le serveur attend les connexions.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-U <replaceable class="parameter">nomutilisateur</replaceable></option></term>
      <term><option>--username=<replaceable class="parameter">nomutilisateur</replaceable></option></term>
      <listitem>
       <para>
        Le nom de l'utilisateur utilisé pour la connexion.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-w</option></term>
      <term><option>--no-password</option></term>
      <listitem>
       <para>
      Ne demande jamais un mot de passe. Si le serveur en réclame un pour
      l'authentification et qu'un mot de passe n'est pas disponible d'une autre
      façon (par exemple avec le fichier <filename>.pgpass</filename>), la
      tentative de connexion échouera. Cette option peut être utile pour les
      scripts où aucun utilisateur n'est présent pour saisir un mot de passe.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>-W</option></term>
      <term><option>--password</option></term>
      <listitem>
       <para>
        Force <application>clusterdb</application> à demander un mot de passe
        avant la connexion à une base de données.
       </para>

       <para>
        Cette option n'est jamais obligatoire car
        <application>clusterdb</application> demandera automatiquement un
        mot de passe si le serveur exige une authentification par mot de
        passe. Néanmoins, <application>clusterdb</application> perdra une
        tentative de connexion pour trouver que le serveur veut un mot de
        passe. Dans certains cas, il est préférable d'ajouter l'option
        <option>-W</option> pour éviter la tentative de connexion.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--maintenance-db=<replaceable class="parameter">nom-base-maintenance</replaceable></option></term>
      <listitem>
       <para>
        Spécifie le nom de la base de données à laquelle se connecter pour
        trouver les bases qui seront regroupées. Si elle n'est pas spécifiée,
        la base de données <literal>postgres</literal> est utilisée; si elle
        n'existe pas, la base <literal>template1</literal> est utilisée à la
        place.
       </para>
      </listitem>
     </varlistentry>
   </variablelist>
  </para>
 </refsect1>


 <refsect1>
  <title>Environnement</title>

  <variablelist>
   <varlistentry>
    <term><envar>PGDATABASE</envar></term>
    <term><envar>PGHOST</envar></term>
    <term><envar>PGPORT</envar></term>
    <term><envar>PGUSER</envar></term>

    <listitem>
     <para>
      Paramètres de connexion par défaut.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   Cet outil, comme la plupart des autres outils <productname>PostgreSQL</productname>,
   utilise aussi les variables d'environnement supportées par la bibliothèque
   <application>libpq</application> (voir <xref linkend="libpq-envars"/>).
  </para>

 </refsect1>


 <refsect1>
  <title>Diagnostiques</title>

  <para>
   En cas de difficulté, voir
   <xref linkend="sql-cluster"/> et <xref linkend="app-psql"/>
   qui présentent les problèmes et messages d'erreur éventuels. Le serveur de
   bases de données doit fonctionner sur l'hôte cible. De plus,
   toutes les configurations de connexion par défaut et variables
   d'environnement utilisées par la bibliothèque client
   <application>libpq</application> s'appliquent.
  </para>

 </refsect1>


 <refsect1>
  <title>Exemples</title>

   <para>
    Grouper la base de données <literal>test</literal>&nbsp;:
<screen><prompt>$ </prompt><userinput>clusterdb test</userinput>
</screen>
   </para>

   <para>
    Grouper la seule table <literal>foo</literal> de la base de données
    nommée <literal>xyzzy</literal>&nbsp;:
<screen><prompt>$ </prompt><userinput>clusterdb --table foo xyzzy</userinput>
</screen>
   </para>

 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="sql-cluster"/></member>
  </simplelist>
 </refsect1>

</refentry>
