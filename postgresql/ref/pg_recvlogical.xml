<?xml version="1.0" encoding="UTF-8"?>
<!--
doc/src/sgml/ref/pg_recvlogical.sgml
PostgreSQL documentation
-->

<refentry id="app-pgrecvlogical">
 <indexterm zone="app-pgrecvlogical">
  <primary>pg_recvlogical</primary>
 </indexterm>

 <refmeta>
  <refentrytitle><application>pg_recvlogical</application></refentrytitle>
  <manvolnum>1</manvolnum>
  <refmiscinfo>Application</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>pg_recvlogical</refname>
  <refpurpose>contrôle les flux de décodage logique de <productname>PostgreSQL</productname></refpurpose>
 </refnamediv>

 <refsynopsisdiv>
  <cmdsynopsis>
   <command>pg_recvlogical</command>
   <arg rep="repeat" choice="opt"><replaceable>option</replaceable></arg>
  </cmdsynopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>
  <para>
   <command>pg_recvlogical</command> contrôle des slots de réplication pour le
   décodage logique et envoie les données par flux depuis ces slots de
   réplication.
  </para>
  <para>
   Il crée une connexion en mode réplication, et est donc sujet aux même
   contraintes que <xref linkend="app-pgreceivewal"/>, en plus de celles de la
   réplication logique (voir <xref linkend="logicaldecoding"/>).
  </para>

  <para>
   <command>pg_recvlogical</command> has no equivalent to the logical decoding
   SQL interface's peek and get modes. It sends replay confirmations for
   data lazily as it receives it and on clean exit. To examine pending data on
    a slot without consuming it, use
   <link linkend="functions-replication"><function>pg_logical_slot_peek_changes</function></link>.
  </para>

 </refsect1>

 <refsect1>
  <title>Options</title>

  <para>
   Au moins une des options suivantes doit être indiquée pour sélectionner une
   action&nbsp;:

   <variablelist>

    <varlistentry>
     <term><option>--create-slot</option></term>
     <listitem>
      <para>
       Crée un nouveau slot de réplication avec le nom spécifié avec
       <option>--slot</option>, utilisant le plugin de sortie spécifié avec
       <option>--plugin</option>, pour la base de données spécifiée par
       <option>--dbname</option>.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--drop-slot</option></term>
     <listitem>
      <para>
       Supprime le slot de réplication dont le nom est spécifié avec l'option
       <option>--slot</option>, puis quitte.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--start</option></term>
     <listitem>
      <para>
       Commence le transfert des modifications à partir du slot de réplication
       spécifié par l'option <option>--slot</option>, et continue jusqu'à être
       arrêté par un signal. Si le flux de modifications côté serveur se
       termine avec un arrêt du serveur ou une déconnexion, tente de nouveau
       dans une boucle, sauf si l'option <option>--no-loop</option> est ajoutée.
      </para>

      <para>
       Le format du flux est déterminé par le plugin en sortie indiqué lors de
       la création du slot.
      </para>

      <para>
       La connexion doit se faire sur la même base de données que celle utilisée
       pour créer le slot.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>

  <para>
   Les actions <option>--create-slot</option> et <option>--start</option>
   peuvent être utilisées ensemble. <option>--drop-slot</option> ne peut pas
   être combinée avec une autre action.
  </para>

  <para>
   L'option de ligne de commande suivante contrôle l'emplacement et le format
   de sortie ainsi que les autres comportements de la réplication&nbsp;:

   <variablelist>

    <varlistentry>
     <term><option>-f <replaceable>nom_fichier</replaceable></option></term>
     <term><option>--file=<replaceable>nom_fichier</replaceable></option></term>
     <listitem>
      <para>
       Écrit les données de transactions reçues et décodées dans ce fichier.
       Utiliser <literal>-</literal> pour la sortie standard (<systemitem>stdout</systemitem>).
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-F <replaceable>interval_secondes</replaceable></option></term>
     <term><option>--fsync-interval=<replaceable>interval_secondes</replaceable></option></term>
     <listitem>
      <para>
       Précise la fréquence des appels à <function>fsync()</function> par
       <application>pg_recvlogical</application> pour s'assurer que le fichier
       en sortie est à coup sûr sur disque.
      </para>

      <para>
       De temps en temps, le serveur demande au client de réaliser les écritures
       et de rapporter sa position au serveur. Ce paramètre permet d'aller
       au-delà, pour réaliser des écritures plus fréquentes.
      </para>

      <para>
       Indiquer un intervalle de <literal>0</literal> désactive tous les appels
       à <function>fsync()</function>. Le serveur est toujours informé de la
       progression. Dans ce cas, des données peuvent être perdues en cas de
       crash.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-I <replaceable>lsn</replaceable></option></term>
     <term><option>--startpos=<replaceable>lsn</replaceable></option></term>
     <listitem>
      <para>
       Dans le mode <option>--start</option>, la réplication commence à la
       position LSN désignée. Pour les détails de son effet, voir la
       documentation dans <xref linkend="logicaldecoding"/> et <xref
       linkend="protocol-replication"/>. Ignoré dans les autres modes.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
      <term><option>-E <replaceable>lsn</replaceable></option></term>
      <term><option>--endpos=<replaceable>lsn</replaceable></option></term>
      <listitem>
       <para>
        In <option>--start</option> mode, automatically stop replication
        and exit with normal exit status 0 when receiving reaches the
        specified LSN.  If specified when not in <option>--start</option>
        mode, an error is raised.
       </para>

       <para>
        If there's a record with LSN exactly equal to <replaceable>lsn</replaceable>,
        the record will be output.
       </para>

       <para>
        The <option>--endpos</option> option is not aware of transaction
        boundaries and may truncate output partway through a transaction.
        Any partially output transaction will not be consumed and will be
        replayed again when the slot is next read from. Individual messages
        are never truncated.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
      <term><option>--if-not-exists</option></term>
      <listitem>
       <para>
        Ne renvoie pas une erreur quand <option>--create-slot</option> est spécifié
        et qu'un slot de ce nom existe déjà.
       </para>
      </listitem>
     </varlistentry>

     <varlistentry>
     <term><option>-n</option></term>
     <term><option>--no-loop</option></term>
     <listitem>
      <para>
       Quand la connexion au serveur est perdue, ne pas tenter de nouveau
       dans une boucle, mais quitte simplement.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-o <replaceable>nom</replaceable>[=<replaceable>valeur</replaceable>]</option></term>
     <term><option>--option=<replaceable>nom</replaceable>[=<replaceable>valeur</replaceable>]</option></term>
     <listitem>
      <para>
       Passe l'option option <replaceable>nom</replaceable> au plugin en sortie
       avec la <replaceable>valeur</replaceable> si elle est spécifiée. Des
       options existent mais leurs effets dépendent du plugin utilisé en sortie.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-P <replaceable>plugin</replaceable></option></term>
     <term><option>--plugin=<replaceable>plugin</replaceable></option></term>
     <listitem>
      <para>
       Lors de la création du slot, utiliser la sortie de plugin de décodage
       spécifiée. Voir <xref linkend="logicaldecoding"/>. Cette option n'a
       pas d'effet si le slot existe déjà.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-s <replaceable>intervalle_en_seconde</replaceable></option></term>
     <term><option>--status-interval=<replaceable>intervalle_en_seconde</replaceable></option></term>
     <listitem>
      <para>
       Cette option a le même effet que l'option du même nom dans <xref linkend="app-pgreceivewal"/>.
       Voir la description à cet endroit.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-S <replaceable>nom_slot</replaceable></option></term>
     <term><option>--slot=<replaceable>nom_slot</replaceable></option></term>
     <listitem>
      <para>
       Dans le mode <option>--start</option>, utilise le slot de réplication
       logique existant nommé <replaceable>slot_name</replaceable>. Dans le
       mode <option>--create-slot</option>, créer le slot de réplication avec ce
       nom. Dans le mode <option>--drop-slot</option>, supprime le slot de ce nom.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-v</option></term>
     <term><option>--verbose</option></term>
     <listitem>
      <para>
       Active le mode verbeux.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>

  </para>

  <para>
   Les options suivantes en ligne de commande contrôlent les paramètres de
   connexion à la base de données.

   <variablelist>
    <varlistentry>
     <term><option>-d <replaceable>nom_base</replaceable></option></term>
     <term><option>--dbname=<replaceable>nom_base</replaceable></option></term>
     <listitem>
      <para>
       La base de données où se connecter. Voir la description des actions de
       sa signification. Cela peut être une chaîne de connexion <application>libpq</application>&nbsp;;
       voir <xref linkend="libpq-connstring"/> pour plus d'informations. La
       valeur par défaut est le nom de l'utilisateur.
       to user name.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-h <replaceable>alias-ou-ip</replaceable></option></term>
     <term><option>--host=<replaceable>alias-ou-ip</replaceable></option></term>
     <listitem>
      <para>
       Indique le nom d'hôte du serveur. Si la valeur commence avec un slash,
       elle est utilisée comme nom du répertoire pour le socket de domaine Unix.
       La valeur par défaut est récupérée de la variable d'environnement
       <envar>PGHOST</envar>. Si cette dernière n'est pas configurée, une
       connexion par socket de domaine Unix est tentée.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-p <replaceable>port</replaceable></option></term>
     <term><option>--port=<replaceable>port</replaceable></option></term>
     <listitem>
      <para>
       Indique le port TCP ou l'extension du fichier de socket de domaine
       Unix, sur lequel le serveur écoute les connexions entrantes. La
       valeur par défaut correspond à la valeur de la variable d'environnement
       <envar>PGPORT</envar>. Si cette variable n'est pas configurée, une
       valeur compilée est prise en compte.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-U <replaceable>nom_utilisateur</replaceable></option></term>
     <term><option>--username=<replaceable>nom_utilisateur</replaceable></option></term>
     <listitem>
      <para>
       Le nom d'utilisateur utilisé pour la connexion. Sa valeur par défaut est
       le nom de l'utilisateur du système d'exploitation.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-w</option></term>
     <term><option>--no-password</option></term>
     <listitem>
      <para>
       Ne demande jamais un mot de passe. Si le serveur requiert une
       authentification par mot de passe et qu'un mot de passe n'est pas
       disponible par d'autres moyens tels que le fichier
       <filename>.pgpass</filename>, la tentative de connexion échouera. Cette
       option peut être utile dans les jobs programmés et dans les scripts
       où aucun utilisateur n'est présent pour saisir un mot de passe.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-W</option></term>
     <term><option>--password</option></term>
     <listitem>
      <para>
       Force <application>pg_recvlogical</application> à demander un mot de
       passe avant de se connecter à une base de données.
      </para>

      <para>
       Cette option n'est jamais obligatoire, car
       <application>pg_recvlogical</application> demandera automatiquement un
       mot de passe si le serveur requiert une authentification par mot de
       passe. Néanmoins, <application>pg_recvlogical</application> gaspillera
       une tentative de connexion pour trouver que le serveur a besoin d'un mot
       de passe. Dans certains cas, il est préférable d'utiliser l'option
       <option>-W</option> pour éviter la tentative de connexion supplémentaire.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>

  <para>
   Les options supplémentaires suivantes sont disponibles&nbsp;:

   <variablelist>

    <varlistentry>
     <term><option>-V</option></term>
     <term><option>--version</option></term>
     <listitem>
      <para>
       Affiche la version de <application>pg_recvlogical</application>, puis
       quitte.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-?</option></term>
     <term><option>--help</option></term>
     <listitem>
      <para>
       Affiche l'aide sur les arguments en ligne de commande de <application>
        pg_recvlogical</application>, puis quitte.
      </para>
     </listitem>
    </varlistentry>

   </variablelist>
  </para>
 </refsect1>

 <refsect1>
  <title>Environnement</title>

  <para>
   Cet outil, comme la plupart des autres outils <productname>PostgreSQL</productname>,
   utilise les variables d'environnement supportées par <application>libpq</application>
   (voir <xref linkend="libpq-envars"/>).
  </para>
 </refsect1>

 <refsect1>
  <title>Exemples</title>

  <para>
   Voir <xref linkend="logicaldecoding-example"/> pour un exemple.
  </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>

  <simplelist type="inline">
   <member><xref linkend="app-pgreceivewal"/></member>
  </simplelist>
 </refsect1>
</refentry>
