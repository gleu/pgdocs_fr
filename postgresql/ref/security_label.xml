<?xml version="1.0" encoding="UTF-8"?>
<refentry id="sql-security-label">
 <refmeta>
  <refentrytitle>SECURITY LABEL</refentrytitle>
  <manvolnum>7</manvolnum>
  <refmiscinfo>SQL - Instructions du langage</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>SECURITY LABEL</refname>
  <refpurpose>Définir ou modifier une label de sécurité appliquée à un objet</refpurpose>
 </refnamediv>

 <indexterm zone="sql-security-label">
  <primary>SECURITY LABEL</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
SECURITY LABEL [ FOR <replaceable class="PARAMETER">fournisseur</replaceable> ] ON
{
  TABLE <replaceable class="PARAMETER">nom_objet</replaceable> |
  COLUMN <replaceable class="PARAMETER">nom_table</replaceable>.<replaceable class="PARAMETER">nom_colonne</replaceable> |
  AGGREGATE <replaceable class="PARAMETER">nom_aggrégat</replaceable> (<replaceable class="PARAMETER">type_aggrégat</replaceable> [, ...] ) |
  DATABASE <replaceable class="PARAMETER">nom_objet</replaceable> |
  DOMAIN <replaceable class="PARAMETER">nom_objet</replaceable> |
  EVENT TRIGGER <replaceable class="PARAMETER">object_name</replaceable> |
  FOREIGN TABLE <replaceable class="PARAMETER">nom_objet</replaceable>
  FUNCTION <replaceable class="PARAMETER">nom_fonction</replaceable> ( [ [ <replaceable class="parameter">mode_arg</replaceable> ] [ <replaceable class="parameter">nom_arg</replaceable> ] <replaceable class="parameter">type_arg</replaceable> [, ...] ] ) |
  LARGE OBJECT <replaceable class="PARAMETER">oid_large_object</replaceable> |
  MATERIALIZED VIEW <replaceable class="PARAMETER">object_name</replaceable> |
  [ PROCEDURAL ] LANGUAGE <replaceable class="PARAMETER">nom_objet</replaceable> |
  ROLE <replaceable class="PARAMETER">nom_objet</replaceable> |
  SCHEMA <replaceable class="PARAMETER">nom_objet</replaceable> |
  SEQUENCE <replaceable class="PARAMETER">nom_objet</replaceable> |
  TABLESPACE <replaceable class="PARAMETER">nom_objet</replaceable> |
  TYPE <replaceable class="PARAMETER">nom_objet</replaceable> |
  VIEW <replaceable class="PARAMETER">nom_objet</replaceable>
} IS '<replaceable class="PARAMETER">label</replaceable>'
</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Description</title>

  <para>
   <command>SECURITY LABEL</command> applique un label de sécurité à un objet de la
   base de données. Un nombre arbitraire de labels de sécurité, un par fournisseur d'labels,
   peut être associé à un objet donné de la base. Les fournisseurs de labels sont des modules dynamiques
   qui s'enregistrent eux-mêmes en utilisant la fonction <function>register_label_provider</function>.
  </para>

  <note>
    <para>
      <function>register_label_provider</function> n'est pas une fonction SQL&nbsp;; elle ne peut
      être appelée que depuis du code C chargé et exécuté au sein du serveur.
    </para>
  </note>

  <para>
   Le fournisseur de labels détermine si un label donné est valide, 
   et dans quelle mesure il est permis de l'appliquer à un objet donné. Le sens
   des labels est également laissé à la discrétion du fournisseur d'labels.
   <productname>PostgreSQL</productname> n'impose aucune restriction
   quant à l'interprétation que peut faire un fournisseur d'un label donné,
   se contentant simplement d'offrir un mécanisme de stockage de ces labels.
   En pratique, il s'agit de permettre l'intégration de systèmes de contrôles d'accès
   obligatoires (en anglais, <foreignphrase>mandatory access control</foreignphrase>
   ou <acronym>MAC</acronym>) tels que <productname>SE-Linux</productname>.
   De tels systèmes fondent leurs autorisations d'accès sur des labels appliqués
   aux objets, contrairement aux systèmes traditionnels d'autorisations d'accès
   discrétionnaires (en anglais, <foreignphrase>discretionary access
   control</foreignphrase> ou <acronym>DAC</acronym>) généralement
   basés sur des concepts tels que les utilisateurs et les groupes.
  </para>
 </refsect1>

 <refsect1>
  <title>Paramètres</title>

  <variablelist>
   <varlistentry>
    <term><replaceable class="parameter">nom_objet</replaceable></term>
    <term><replaceable class="parameter">nom_table.nom_colonne</replaceable></term>
    <term><replaceable class="parameter">nom_aggr</replaceable></term>
    <term><replaceable class="parameter">nom_fonction</replaceable></term>
    <listitem>
     <para>
      Le nom de l'objet. Ce sont les noms des tables, aggrégats,
      domaines, tables distantes, fonctions, séquences, types et vues qui 
      peuvent être qualifiés du nom de schéma.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">fournisseur</replaceable></term>
    <listitem>
     <para>
      Le nom du fournisseur auquel le label est associé. Le fournisseur
      désigné doit être chargé et accepter l'opération qui lui est proposée.
      Si un seul et unique fournisseur est chargé, le nom du fournisseur peut être omis
      par soucis de concision.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">type_arg</replaceable></term>
    <listitem>
     <para>
      Le type de donnée en entrée sur lequel la fonction d'aggrégation doit opérer.
      Pour référencer une fonction d'aggrégation sans argument, il convient d'écrire <literal>*</literal>
      en guise de liste de types de données.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">mode_arg</replaceable></term>

    <listitem>
     <para>
      Le mode d'un argument de fonction&nbsp;: <literal>IN</literal>, <literal>OUT</literal>,
      <literal>INOUT</literal> ou <literal>VARIADIC</literal>.
      Si le mode est omis, le mode par défaut <literal>IN</literal> est alors appliqué.
      À noter que <command>SECURITY LABEL ON FUNCTION</command> ne porte
      actuellement pas sur les arguments de mode <literal>OUT</literal> dans la mesure
      où seuls les arguments fournis en entrée sont nécessaires à l'identification d'une fonction. 
      Il suffit donc de lister les arguments <literal>IN</literal>, <literal>INOUT</literal>, 
      et <literal>VARIADIC</literal> afin d'identifier sans ambiguïté une fonction.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">nom_arg</replaceable></term>

    <listitem>
     <para>
      Le nom d'un argument de fonction.
      À noter que <command>SECURITY LABEL ON FUNCTION</command> ne porte
      actuellement pas sur les nom des arguments fournis aux fonctions dans la mesure
      où seul le type des arguments est nécessaire à l'identification d'une fonction.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">type_arg</replaceable></term>

    <listitem>
     <para>
      Le ou les types de données des arguments des fonctions, si elles en comportent, éventuellement 
      qualifiés du nom de schéma.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">oid_large_objet</replaceable></term>
    <listitem>
     <para>
      L'OID de l'objet large.
     </para>
    </listitem>
   </varlistentry>

    <varlistentry>
     <term><literal>PROCEDURAL</literal></term>

     <listitem>
      <para>
       Qualificatif optionnel du langage, peut être omis.
      </para>
     </listitem>
    </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">label</replaceable></term>
    <listitem>
     <para>
      Le nom du label à affecter, fourni sous la forme d'une chaine littérale
      ou <literal>NULL</literal> pour supprimer un label de sécurité précédemment affecté.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>

 <refsect1>
  <title>Exemples</title>

  <para>
   L'exemple suivant montre comment modifier le label de sécurité d'une table.

<programlisting>
SECURITY LABEL FOR selinux ON TABLE matable IS 'system_u:object_r:sepgsql_table_t:s0';
</programlisting>
  </para>
 </refsect1>

 <refsect1>
  <title>Compatibilité</title>
  <para>
   La commande <command>SECURITY LABEL</command> n'existe pas dans le standard <acronym>SQL</acronym>.
  </para>
 </refsect1>

 <refsect1>
  <title>Voir aussi</title>
  <simplelist type="inline">
   <member><xref linkend="sepgsql"/></member>
   <member><xref linkend="dummy-seclabel"/></member>
  </simplelist>
 </refsect1>
</refentry>
