---
Slony-I Téléchargement rapide 
http://main.slony.info/downloads
2008-09-12
Chris Browne

Slony-1 2.0.3 <a href="http://main.slony.info/downloads/2.0/source/slony1-2.0.3.tar.bz2">engine</a>
<a href="http://main.slony.info/downloads/2.0/source/slony1-2.0.3-docs.tar.bz2">documentation</a>
<br/>
Slony-1 1.2.21 <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.21.tar.bz2">engine</a>
<!-- <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.21-docs.tar.bz2">documentation</a> -->
<br/>
Slony-1 1.1.9 <a href="http://main.slony.info/downloads/1.1/source/slony1-1.1.9.tar.bz2">engine</a>
<!-- Please keep this item at the top of the news list -->

---
Slony-I 1.2.21  available
http://main.slony.info/downloads/1.2/source/slony1-1.2.21.tar.bz2
2010-04-09
Steve Singer

The next minor release of the Slony1 1.2 branch (1.2.21) has been released

<ul>

<li> Bug #108 - remove Emacs fodder from test scripts </li>

<li> Bug #110 - some quoting problems in Perl script </li>

<li> Free objects to eliminate memory leaks </li>

<li> Bug #55 - cannot use va_args multiple times + test case with very large
  tuple </li>

<li> SPI_getbinval() fix for PostgreSQL 9.0 support </li>

<li> Add buffer for pid </li>

<li> Change "long long" to "int64" to make things consistent with how PostgreSQL
  expresses XIDs.  </li>

<li> Similarly "%lld" in printf changed to INT64_FORMAT </li>

<li> slony1_extract_schema.sh checks Pg version numbers </li>

<li> Added tools/slony1_extract_for_upgrade.sh script </li>
</ul>


---
Slony-I 2.0.3  available
http://main.slony.info/downloads/2.0/source/slony1-2.0.3.tar.bz2
2010-04-09
Chris Browne

Slony-I 2.0.3 is now available.  It
makes the following changes since 2.0.2

<ul>

<li> Bug #103 - When adding snapshot entries, they should be "1:1:", not "0:0:"

<li> autoconf/C funcs change to cope with 8.5 change that ScanKeywordLookup has
  3 arguments rather than 1 (in previous versions)

<li> Remove Emacs fodder from tools (bug #108)

<li> Quoting problems in Perl script (bug #110)
<li> Add notes about flex/bison conflict (bug #109)

<li> <a href="http://lists.slony.info/pipermail/slony1-hackers/2010-January/000292.html"> Memory leak changes per Ulrich Weber</a>

<li> Logic error (if versus "else if") noticed by Richard Yen

<li> Bug #106 - misleading error message when setting up session configuration

<li> Improve test harness to report conninfo in case where connection fails

<li> Bug #55 - va_args cannot be used multiple times

<li> Bug # 113 - DROP cloneNodePrepare since the return type changes.
  Patch from Atte Peltomäki
<li> Improve configure complaint if it can't find PQunescapeBytea - this
  likely implies that configure couldn't find libpq.

<li> Copyright date changes

<li> Added discussion of synchronous commit to documentation

<li> Removed some discussion of behaviours relating to ancient versions
  of PostgreSQL that are no longer supported (David Fetter)

<li> SPI_getbinval() was being passed a NULL, which PostgreSQL 8.5 no
  longer accepts.  Add isnull variable in the relevant code block so
  there's a place to stow the bool result.

 <P> Reason for this noted by Alvaro Herrera - thanks!

<li> Change "long long" to "int64" to make things consistent with how
  PostgreSQL expresses XIDs.

<li> Similarly "%lld" in printf changed to INT64_FORMAT

<li> Fixing up detection by Slonik of PostgreSQL 8.4 (patch per Peter
  Eisentraut) - bug #116

<li>Updates to copyright dates on files

<li>Bug #98 - need WAIT ON parameter in slonik code generated by
  slonik_move_set altperl script.

<li>Change default $LOGDIR, so that distros won't need to patch it.

<li>Fix LOG_NAME_SUFFIX feature. Thanks to David Fetter and Andrew Dunstan.

<li>Improve documentation on EVENT NODE for STORE NODE command

<li>SLONLOG directory changes for Red Hat-related distributions

<li>Bug #97 - insert into sl_setsync upon FAILOVER had values() clause based on the
  pre-2.0 schema; fix to use 2.0.

<li>UPGRADE FUNCTIONS failing because functions had their return types changed.
  Added in "DROP FUNCTION IF EXISTS" (fine in 8.3+) in
  src/backend/slony1_funcs.sql to rectify this.

<li>As observed by Bernd Helmle, cloneNodePrepare returns an event ID,
  and hence should return BIGINT

<li>Introduced ShouldSlonyVacuumTable() function for 8.3 so we cope with
  differences in vacuum handling between 8.3 and 8.4+

<li>Fix 8.4-ism relating to subscription retries
  <a href="http://lists.slony.info/pipermail/slony1-commit/2009-October/002728.html"> see commit notes </a>

<li> Doc fixes
<li> Fixes to integer castings - don't assume this is automagically handled
<li> Changed return types of functions returning event numbers <tt>bigint</tt> 
<li> Fixes to altperl samples and such

<li>PostgreSQL 8.4 has been released; slonik needs to explicitly recognize it

<li>Add in slonikconfdump.sh tool, which generates a slonik script to duplicate
  the configuration of a Slony-I cluster

<li>Significant fixes to documentation to reflect 2.0 changes

<li>Add "OMIT COPY" option to the Slonik "SUBSCRIBE SET" command

<li>Document process for Slony-I 2.0 upgrade using OMIT COPY option

<li>Fix to race condition where file descriptor copies were being made at
  the wrong time in the scheduler

<li>Modify "testseqnames" regression test to create a whole bunch of
  sequences to validate that things don't break down with either lots of
  them, or where IDs are large numbers

<li>Change minimum debugging level to -1 to allow suppressing logging

<li>Bug #92 - compression of event numbers had a bug where events >
  2^31-1 would overflow the "int" value

<li>Autovacuum handling changes in PostgreSQL 8.4 - we pull metadata
  from pg_class.reloptions, instead of pg_autovacuum

<li>logswitch fix resolving a potential data loss + statement blocking
  bug...

  Before attempting to TRUNCATE the sl_log_* tables, we need to
  successfully request an exclusive lock.  By doing so in an
  exception block with NOWAIT option, this can "lose" gracefully.

<li>Add LOG_NAME_SUFFIX to altperl tools

</ul>
---
Slony-I 1.2.20 available
http://main.slony.info/downloads/1.2/source/slony1-1.2.20.tar.bz2
2009-12-09
Chris Browne

<P> Release 1.2.20 has the following changes:

<ul>
<li> Fix problem with logging where vsnprintf would, with very large
  output, clobber the byte after malloc()ed output</li>

<li> Change "long long" to "int64"</li>

</ul>

Yes, that's a rapid series of changes :-(
---
Slony-I 1.2.19 available
http://main.slony.info/downloads/1.2/source/slony1-1.2.19.tar.bz2
2009-12-09
Chris Browne

<P> Release 1.2.19 has the following changes:

<ul>
<li> Fix problems with drop_if_exists()</li>
<li> Add tests to duct tape tests that bump event numbers to test 2^31 "rollover" issue, and to run UPDATE FUNCTIONS</li>
</ul>
---
Sortie de Slony-I 1.2.18
http://main.slony.info/downloads/1.2/source/slony1-1.2.18.tar.bz2
2009-12-01
Chris Browne

<P> La version 1.2.18 apporte les changements suivant :

<ul>
<li> Modification du script autoconf + changement dans src/backend/slony1_funcs.c pour s'adapter
au changment du nombre d'arguments de ScanKeywordLookup dans PostgreSQL 8.5</li>

<li> Le rechargement de fonctions doit avoir une émulation de 
  "DROP FUNCTION IF EXISTS" car deux fonctions ont changé de code
  de retour, ce qui ne marche plus correctement dans 
  CREATE OR REPLACE FUNCTION. </li>

<li> Modifications de la notice de copyright pour indiquer l'année 2009 </li>

<li> correction de code spécifique à la version  8.4 de PostgreSQL dans le processus SUBSCRIBE SET - voir <a href="http://main.slony.info/viewcvs/viewvc.cgi/slony1-engine/src/slon/remote_worker.c?revision=1.124.2.39&view=markup&sortby=date&pathrev=REL_1_2_STABLE"> les changement dans le CVS </a></li>
</ul>
---
Sortie de Slony-I 2.0.3
http://www.slony.info/downloads/2.0/source/slony1-2.0.3-rc3.tar.bz2
2009-11-20
Chris Browne

Version <a href=
"http://www.slony.info/downloads/2.0/source/slony1-2.0.3-rc3.tar.bz2">
slony1-2.0.3-rc3.tar.bz2 </a> vient de sortir.

<p>Cette version corrige plusieurs choses depuis la version RC précendente :
<ul>
<li>Mise à jour des dates de copyright

<li>Bug #98 - Besoin d'un paramètre WAIT ON dans le code slonik produit par
  le script altperl : slonik_move_set.

<li>Changement du $LOGDIR par défaut, afin que les distributions n'aient pas à la modifier.
 
<li>Correction de la fonctionnalité LOG_NAME_SUFFIX, grace à David Fetter et Andrew Dunstan.

<li>Amélioration de la documentation d'EVENT NODE pour la commande STORE NODE.

<li>Modification du repértoire SLONLOG pour la distribution Red Hat et ses dérivées.

<li>Bug #97 - insert into sl_setsync pendant une bascule sur panne ("FAILOVER") utilisait 
la clause values() en se basant sur le schéma avant-2.0; corrigé pour utilisé le schéma 2.0.

<li>Echec des fonctions d'UPGRADE car leur code retour a changé.
  Ajout de "DROP FUNCTION IF EXISTS" (à partir de 8.3+) dans
  src/backend/slony1_funcs.sql poru corriger cela

<li>Comme le remarque Bernd Helmle, cloneNodePrepare retourne un identifiant d'événement,
  et devrait donc retourner un BIGINT

<li>Introduction de la fonction ShouldSlonyVacuumTable() pour la version 8.3 afin de gérer les 
différences de traitement des vacuums entre la version 8.3 et la 8.4+

<li>Correction de code spécifique à la version 8.4 en rapport avec les re-tentatives de souscription 
 <a href="http://lists.slony.info/pipermail/slony1-commit/2009-October/002728.html"> voir les notes de commit</a>

</ul>
---
La version 1.2.17 est sortie 
http://main.slony.info/downloads/1.2/source/slony1-1.2.17-rc.tar.bz2
2009-10-14
Chris Browne

Le version <a href=
"http://main.slony.info/downloads/1.2/source/slony1-1.2.17.tar.bz2">
slony1-1.2.17.tar.bz2 </a> est disponible.

<P>Voici les changements par rapport à la version 1.2.16 :
<ul>

<li> Applications des changes du  logshipper qui ont été effectué dans la branche 2.0

<li> Changement du niveau minimum de deboggage :  -1 pour ne rien tracer

<li> Bug #92 - la compression des nombres d'événement avait un  bug lorsque le nombre d'événement dépassait
  la valeur max de "int" (2^31-1) 

<li> Correction d'une situation de concurrence ("race condition") lorsque les copies de descripteur de fichiers
 étaient faites au mauvais moment par l'ordonnanceur.

<li> Correction du code retour pour qu'il utiliser bigint lorsqu'il s'agit d'un identifiant d'évènement.

<li> Etablir la compatibilité avec  PostgreSQL 8.4:

<ul>
  <li> Les infos d'autovacuum sont dans pg_class plutot que dans pg_autovacuum
  <li> utilisation de GetActiveSnapshot() plutot que d'attendre un SerializableSnapshot
  à partir du moteur

  <li> createdb doit cloner template0 pour s'assurer que les locales correspondent

  <li> pg_class.reltriggers n'existe plus dans 8.4 et donc ne doit plus être touché

</ul>
</ul>
---
Sortie de la version candidate 2.0.3RC2
http://main.slony.info/downloads/2.0/source/slony1-2.0.3-rc2.tar.bz2
2009-08-12
Chris Browne

La version <a href=
"http://main.slony.info/downloads/2.0/source/slony1-2.0.3-rc2.tar.bz2">
slony1-2.0.3-rc2.tar.bz2 </a> est disponible.

<p> Cette version corrige une series de choses depuis la précédente version RC :

<ul>
<li> Correction de la doc
<li> Correction des conversions d'entiers - ne pas s'attendre à ce que ce soit fait automagiquement
<li> Modification de codes de retours retournant des numéros d'évèvenement (utilisation de <tt>bigint</tt>) 
<li> Corrections des exemples altperl.
</ul>

---
Sortie de Slony-I 2.0.3RC2 (Version Candidate)
http://main.slony.info/downloads/2.0/source/slony1-2.0.3-rc2.tar.bz2
2009-08-12
Chris Browne

La version <a href=
"http://main.slony.info/downloads/2.0/source/slony1-2.0.3-rc2.tar.bz2">
slony1-2.0.3-rc2.tar.bz2 </a> est désormais disponible.

Ceci corrige un certain nombre de problèmes trouvés dans la précédente RC :

<ul>
<li> Corrections de la doc
<li> Corrections des conversions en entier (Ne pas présumer qu'elles sont gérées
automatiquement )
<li> Changement des types de retour pour les fonctions retournant des numéros 
d'événement en <tt>bigint</tt> 
<li> Correction des exemples altperl, etc. 
</ul>
---
Sortie de Slony-I 1.2.17RC (Version Candidate)
http://main.slony.info/downloads/1.2/source/slony1-1.2.17-rc.tar.bz2
2009-07-29
Chris Browne

La version <a href=
"http://main.slony.info/downloads/1.2/source/slony1-1.2.17-rc.tar.bz2">
slony1-1.2.17-rc.tar.bz2 </a> est désormais disponible.

<P>Les changement depuis la version 1.2.16 sont les suivants :
<ul>

<li> Appliquer les changement sur l'exporteur de log qui ont été passé
sur la branche 2.0 mais pas sur la  1.2

<li> Changement du niveau de debug minimum à -1 pour permettre la 
désactivation des traces

<li> Bug #92 - la compression des numéros d'événements
dépassait le plafond de type "int"  quand le nombre d'événements dépasse  2^31-1

<li> Correction d'une situation de concurrence ("race condition") 
lorsque les copies de descripteur de fichier sont effectuées au mauvais moment 
par le planificateur

<li> Établir la compatibility with PostgreSQL 8.4:

<ul>
  <li> Les données d'autovacuum sont dans pg_class plutot que pg_autovacuum

  <li> Utilisation de GetActiveSnapshot() plutot que 
    SerializableSnapshot

  <li> createdb doit utiliser template0 pour s'assurer qu'il peut 
  utiliser les locales

  <li> pg_class.reltriggers n'existe plus dans  8.4 et ne doit plus être
	touché.

</ul>
</ul>
---
Sortie de Slony-I 2.0.3RC (Version Candidate)
http://main.slony.info/downloads/2.0/source/slony1-2.0.3-rc.tar.bz2
2009-07-29
Chris Browne

La version <a href=
"http://main.slony.info/downloads/2.0/source/slony1-2.0.3-rc.tar.bz2">
slony1-2.0.3-rc.tar.bz2 </a> est disponible.

<P>Les changements depuis la version 2.0.2 sont les suivants :

<ul>
<li>PostgreSQL 8.4 est sorti; slonik doit savoir le reconnaitre.

<li>Ajout de l'outil slonikconfdump.sh, qui produit un script 
slonik pour dupliquer la configuration d'un cluster Slony-I

<li>Corrections importante dans la documentation pour tenir compte
des changements de la version 2.0

<li>Ajout de l'option "OMIT COPY" à la commande "SUBSCRIBE SET"

<li>Documentation du  processus de montée de version vers Slony-I 2.0 
avec l'option OMIT COPY

<li> Correction d'une situation de concurrence ("race condition")
lorsque les copies de descripteur de fichier sont effectuées au mauvais moment
par le planificateur

<li>Modification du test de régression "testseqnames" 
pour créer une grande quantité de séquences afin de 
valider rien ne perturbe les grandes séquences et les identifiants
élevés de séquences

<li> Changement du niveau de debug minimum à -1 pour permettre la
désactivation des traces

<li> Bug #92 - la compression des numéros d'événements
dépassait le plafond de type "int"  quand le nombre d'événements dépasse  2^31-1


<li> Les données d'autovacuum sont dans pg_class plutot que pg_autovacuum

<li> Résolution d'un bug un niveau des changements de log pouvant entrainer
une perte de données + correction d'un bug bloquant les requêtes.

  Avant de tenter un TRUNCATE sur les tables sl_log_*, il faut obtenir
  un verrou exclusif. Si on demande ce verrou dans un bloc d'exception
  avec l'option NOWAIT, on peut entrainer des complications. 


<li>Ajout de LOG_NAME_SUFFIX dans les outils altperl
</ul>
---
Mise à jour de la doc en ligne (version 2.0.2)
http://www.slony.info/documentation
2009-07-14
Chris Browne

La documentation en ligne a été mise à jour pour tenir compte 
des évolutions de la version 2.0.2; il y a des changements conséquents 
depuis la version 2.0.1.
---
Sortie de Slony-I 2.0.2
http://main.slony.info/downloads/2.0/source/slony1-2.0.2.tar.bz2
2009-05-08
Chris Browne

La version <a href=
"http://main.slony.info/downloads/2.0/source/slony1-2.0.2.tar.bz2">
slony1-2.0.2.tar.bz2 </a> est désormais disponible.

<p>Les changements depuis la version 2.0.1 sont les suivants :

<ul>
<li> Compatibilité avec PostgreSQL 8.4 - src/backend/slony1_funcs.c a besoin de    #include "catalog/pg_type.h"; qui n'est plus inclut implicitement par le 
   #include SPI

<li> Correction du bug #71 - l'export de configuration échouait
lorsque les chaines de caractères étaient NULL

<li> Correction du  bug #76 - REPAIR CONFIG pouvait provoquer des
  collisions pendant le chargement d'un schéma, lorsqu'une entrée 
  de la table sl_table avait déjà un OID qui correspond par erreur à
  une valeur qu'un autre update essaie de modifier.
 
<P>  Cela provoque l'échec de  REPAIR CONFIG.

<P>  Lorsque cela ce passait dans une requête qui met à jour
  les oids des tables sl_table et sl_sequence avec les valeurs
  sélectionnées aléatoirement depuis pg_class qui ne correspondent 
  à rien ( puisque les valeurs sélectionnées proviennent d'objets qui 
  ne sont ni des tables, ni des séquences) 

<li> Mise à jour des notes de version pour indiquer que la version  2.0
ne supporte que PostgreSQL 8.3+

<li> Changement dans configure.ac pour permettre son utilisation dans
avec autoconf 2.63; quelque chose clochait dans le traitement de 
SLONREL_VERSION

<li> Correction du makefile du guide d'administration

<li> Plusieurs changement dans le guide d'administration

<li> Ajout d'un test supplémentaire sur le nom de schéma
pour valider que tout fonctionne même si il n'y a pas de 
schéma "public" dans la base.

<li> Correction de bug dans tools/start_slon.sh

<li> Correction d'une substitution de chemin dans deux des scripts altperl 

<li> Ajout d'un test qui valide que le nom du schema de cluster est correct; 
  pgAdminIII autorisait l'utilisation de noms de cluster que 
slonik refusait.

<li> Revision des tests de régression pour utiliser SYNC/WAIT FOR EVENT 
à la place de requêtes qui essaient de coordonner l'information dans 
sl_status de manière moins pertinente.

</ul>
---
Sortie de Slony-I 1.2.16
http://main.slony.info/downloads/1.2/source/slony1-1.2.16.tar.bz2
2009-05-08
Chris Browne

La version <a href=
"http://main.slony.info/downloads/1.2/source/slony1-1.2.16.tar.bz2">
slony1-1.2.16.tar.bz2 </a> est désormais disponible.

Changement depuis la version 1.2.15:
<ul>
<li> Correction de problèmes lors des bascules d'urgence ("failover") :
<ul>
<li> La bascule échouait (ERROR) lorsqu'il n'y avait aucun chemin vers
le noeud de sauvegarde. Ceci a été changé en simple avertissement ( WARNING )
pour que la bascule puisse se faire; L'administrateur devrait toutefois 
corriger les chemins ultérieurement </li>
<li> Apparement, les bascules d'urgence ne fontionnaient pas vers les 
noeuds qui n'étaient pas abonnés au noeud endommagé. 
L'erreur logique dans la fonction failedNode() a été corrigée.
<li> Correction d'un probleme qui empechait slonik de réaliser une bascule 
d'urgence si plusieurs noeuds origine tombaient simultanément.
</ul></li>
<li> Correction de l'incompatibilité avec autoconf 2.63 </li>
<li> Répercution des dernières mises à jour de la branche 2.0</li>
</ul>
---
Sortie de Slony-I 2.0.2 (Version Candidate)
http://main.slony.info/downloads/2.0/source/slony1-2.0.2-rc.tar.bz2
2009-04-30
Chris Browne

La nouvelle version <a href=
"http://main.slony.info/downloads/2.0/source/slony1-2.0.2-rc.tar.bz2">
slony1-2.0.2-rc.tar.bz2 </a> est disponible.

<ul>
<li> Compatibilité à PostgreSQL 8.4 :  src/backend/slony1_funcs.c avait besoin
  #include "catalog/pg_type.h"; qui n'est plus inclue implicitmeent par 
  le #include SPI

<li> Correction du bug #71 - l'export de configuration (dump) échouait sur 
les champs string dont la valeur était NULL

<li> Correction du  bug #76 - REPAIR CONFIG pouvait provoquer des
  collisions pendant le chargement d'un schéma, lorsqu'une entrée
  de la table sl_table avait déjà un OID qui correspond par erreur à
  une valeur qu'un autre update essaie de modifier.

<P>  Cela provoque l'échec de  REPAIR CONFIG.

<P>  Lorsque cela ce passait dans une requête qui met à jour
  les oids des tables sl_table et sl_sequence avec les valeurs
  sélectionnées aléatoirement depuis pg_class qui ne correspondent
  à rien ( puisque les valeurs sélectionnées proviennent d'objets qui
  ne sont ni des tables, ni des séquences)

<li> Mise à jour des notes de version pour indiquer que la version  2.0
ne supporte que PostgreSQL 8.3+

<li> Changement dans configure.ac pour permettre son utilisation dans
avec autoconf 2.63; quelque chose clochait dans le traitement de
SLONREL_VERSION

<li> Correction du makefile du guide d'administration

<li> Plusieurs changement dans le guide d'administration

<li> Ajout d'un test supplémentaire sur le nom de schéma
pour valider que tout fonctionne même si il n'y a pas de
schéma "public" dans la base.

<li> Correction de bug dans tools/start_slon.sh

<li> Correction d'une substitution de chemin dans deux des scripts altperl

<li> Ajout d'un test qui valide que le nom du schema de cluster est correct;
  pgAdminIII autorisait l'utilisation de noms de cluster que
slonik refusait.

<li> Revision des tests de régression pour utiliser SYNC/WAIT FOR EVENT
à la place de requêtes qui essaient de coordonner l'information dans
sl_status de manière moins pertinente.

</ul>


---
Sortie de Slony-I 1.2.16 (Version Candidate) 
http://main.slony.info/downloads/1.2/source/slony1-1.2.16-rc.tar.bz2
2009-04-30
Chris Browne

La version <a href=
"http://main.slony.info/downloads/1.2/source/slony1-1.2.16-rc.tar.bz2">
slony1-1.2.16-rc.tar.bz2 </a> est disponible..

Voici les principaux changements :
<ul>
<li> Correction de problèmes lors des bascules d'urgence ("failover") :
<ul>
<li> La bascule échouait (ERROR) lorsqu'il n'y avait aucun chemin vers
le noeud de sauvegarde. Ceci a été changé en simple avertissement ( WARNING )
pour que la bascule puisse se faire; L'administrateur devrait toutefois
corriger les chemins ultérieurement </li>
<li> Apparement, les bascules d'urgence ne fontionnaient pas vers les
noeuds qui n'étaient pas abonnés au noeud endommagé.
L'erreur logique dans la fonction failedNode() a été corrigée.
<li> Correction d'un probleme qui empechait slonik de réaliser une bascule
d'urgence si plusieurs noeuds origine tombaient simultanément.
</ul></li>
<li> Correction de l'incompatibilité avec autoconf 2.63 </li>
<li> Répercution des dernières mises à jour de la branche 2.0</li>
</ul>

---
Sortie de Slony1-ctl : outils de controle pour Slony
http://slony1-ctl.projects.postgresql.org/
2009-04-13
Chris Browne

<a href="http://slony1-ctl.projects.postgresql.org/">
Slony1-ctl </a> est un ensemble de scripts shell qui simplifient 
la gestion quotidienne d'un cluster de réplication Slony1

<P> Licence: BSD

<P> <B>Principe:</B> 
<p>  Une fois que les noeuds de réplication et les relations entre
les noeuds sont définies, on peut facilement administrer le cluster de 
réplication en appelant un des scripts, sans avoir à rédiger des scripts
slonik.

<b>Fonctionnalités:</b>
<ul>
 <li> Initialisation de  la réplication
 <li> Ajout /Suppression de  noeuds
 <li> Ajout d'un ensemble de réplication
 <li> Possibilité de définir une réplication croisée
 <li> Ajout d'objets
 <li> Bascule controlée (switchover) et bascule d'urgence (failover)
 <li> Arrêt/Redémarrage des démons de réplication 
 <li> Execution de scripts DDL
</ul>
---
Sorti de Slony-I 2.0.1 
http://main.slony.info/downloads/2.0/source/slony1-2.0.1.tar.bz2
2009-02-26
Chris Browne

<P> Cette version corrige un certain nombre de problèmes
trouvés dans la version 2.0.0

<ul>
<li> Bug #69 - Le type vactables était référencé avant les UPGRADE FUNCTIONS qui 
pouvait les créer lors d'une mise à jour de version.

<P>  Cela entrainait l'échec des  UPGRADE FUNCTIONS.

<li> Bug #64 - l'utilisation les niveaux de syslog comportait un 
un ordre "break" inapproprié qui entrainait la perte des journaux d'activité.

<P> Si vous avez plusieurs clusters dont le nom était un sous-ensemble 
d'un autre nom, alors slon-tools.pm identifiait les deux lorsqu'il recherchait 
les processus liés au nom le plus court. Un espace a été ajouté dans 
la partie adéquate du code de slon-tools.pm

<li> Les bascules d'urgence effectuaient une insertion sur un nombre de colonnes incorrect.
Cela était du au changement dans la gestion des images ( "snapshots" ), qui était fait sur 
3 colonnes dans les versions 8.3+, alors que désormais il existe un type "snapshot".

<li> Corrections d'erreurs de syntaxe dans tools/altperl/slon_watchdog.pl

<li> Ajout d'un exemple cleanup_interval dans le fichier d'exemple slon.conf 

<li> Ajout de la configuration de cleanup_interval dans les tests de régression

<li> Ajout de documentation pour les cas complexes de bascule d'urgence

<li> Correction des notes d'installation pour indiquer que xxid.so n'existe plus dans Slony-I 2.0+

<li> Correction de faute typographiques dans la documentation

<li> Correstion d'une erreur dans le code de nettoyage. D'anciennes informations contenues dans 
sl_log_1/sl_log_2 n'étaient pas supprimées.

<li> Correction d'erreur dans  altperl/slontools

<li> Ajout des préliminaires pour la mise à jour de 1.2 vres 2.0 - discussion sur ce que cet outil 
doit faire 

<li> Bug #63 - Dépassement de tableau dans logtrigger()
</ul>

---
No way currently to upgrade from Slony-I 1.2.x to 2.0.x
http://www.slony.info/bugzilla/show_bug.cgi?id=69
2008-12-19
Chris Browne

<P> Unfortunately, it needs to be noted that there is not, as of yet,
an upgrade procedure to upgrade an installation of Slony-I 1.2.x to
2.0.  At present, upgrading to 2.0 will essentially require dropping
out replication and recreating it.

<P> We hope to have an answer as to how to deal with this in the new year.
---
Slony-I 2.0.0 Released
http://main.slony.info/downloads/2.0/source/slony1-2.0.0.tar.bz2
2008-11-24
Chris Browne

Differences from 1.2 stream

<ul>
<li> Removal of TABLE ADD KEY

<li> It drops all support for databases prior to Postgres version 8.3.

<p>This is required because we now make use of new functionality in
Postgres, namely the trigger and rule support for session replication
role. As of now, every node (origin/subscriber/mixed) can be dumped with
pg_dump and result in a consistent snapshot of the database.

<li> Still need alterTableRestore() for the upgrade from 1.2.x to 2.0.
upgradeSchema() will restore the system catalog to a consistent
state and define+configure the new versions of the log and deny_access
triggers. 

<li> Fix EXECUTE SCRIPT so that it records the ev_seqno for WAIT FOR EVENT
and make sure all DDL is executed in session_replication_role "local"
on the origin as well as all subscribers. This will cause the slony
triggers to ignore all DML statements while user triggers follow the
regular configuration options for ENABLE [REPLICA/ALWAYS] or DISABLE.

<li> Let the logshipping files also switch to session_replication_role =
"replica" or "local" (for DDL).

<li> Sequence tracking becomes enormously less expensive; rather than
polling *ALL* sequence values for each and every SYNC, the slon
stores the last value, and only records entries in sl_seqlog when
the value changes from that last value.  If most sequences are
relatively inactive, they won't require entries in sl_seqlog very
often.

<li> Change to tools/slony1_dump.sh (used to generate log shipping dump);
  change quoting of "\\\backslashes\\\" to get rid of warning

<li> Cleanup thread revised to push most of the logic to evaluate which
  tables are to be vacuumed into a pair of stored functions.

<P>  This fairly massively simplifies the C code.

<li> Revised logging levels so that most of the interesting messages are
  spit out at SLON_CONFIG and SLON_INFO levels.  This can allow users
  to drop out the higher DEBUG levels and still have useful logs.

<li> Changed log selection query to be less affected by long running
  transaction.  This should help, in particular, the scenario where
  it takes a very long time to subscribe to a set.  In that situation,
  we have had the problem where applying the later SYNCs gets
  extremely costly as the query selecting logs wound up forced into a
  Seq Scan rather than an index scan.

<li> Removed all support for STORE/DROP TRIGGER commands. Users 
  should use the ALTER TABLE [ENABLE|DISABLE] TRIGGER functionality 
  available directly in Postgres from now on.

<li> Improve Wiki page generation script so that it has an option to add in
  a set of [[Category:Foo]] tags to allow automated categorization.

<li> Documented how to fix tables that presently use Slony-I-generated
  primary key candidates generated by TABLE ADD KEY

<li> Add some specific timestamps during the 2007 "DST rule change
  ambiguous time" (e.g. - during the period which, under former rules,
  was not DST, but which now is, due to the recent rule change).

<P>  Bill Moran ran into some problems with such dates; varying
  PostgreSQL versions returned somewhat varying results.  This wasn't
  a Slony-I problem; the data was indeed being replicated correctly.

<li> Made configure a bit smarter about automatically locating
  docbook2man-spec.pl on Debian, Fedora, BSD.

<li> Tests now generate |pipe|delimited|output| indicating a number of
  attributes of each test, including system/platform information,
  versions, and whether or not the test succeeded or failed.

<li> Revised functions that generate listen paths

<li> tools/configure-replication.sh script permits specifying a
  destination path for generated config files.  This enables using
  it within automated processes, and makes it possible to use it to
  generate Slonik scripts for tests in the "test bed," which has
  the further merit of making tools/configure-replication.sh a
  regularly-regression-tested tool.

<li> Fix to bug #15 - where long cluster name (>40 chars) leads to
  things breaking when an index name is created that contains
  the cluster name.

  <P> Warn upon creating a long cluster name.
  <p> Give a useful exception that explains the cause rather
     than merely watching index creation fail.

<p><a href=   "http://www.slony.info/bugzilla/show_bug.cgi?id=15"> Bug 15 </a>

<li> Fix for bug #19 - added a script to help the administrator
  search for any triggers on the database that is the source for
  a schema that is to be used to initialize a log shipping node.

<p>  The problem is that some/most/sometimes all triggers and rules
  are likely to need to be dropped from the log shipping node lest
  they interfere with replication.

<li> Elimination of custom "xxid" functions

<P>  PostgreSQL 8.3 introduces a set of "txid" functions and a
  "txid_snapshot" type, which eliminates the need for Slony-I to have
  its own C functions for doing XID comparisons.

<p>  Note that this affects the structure of sl_event, and leads to some
  changes in the coding of the regression tests.

<p>  This eliminates the src/xxid directory and contents

<li> All of the interesting cleanup work is now done in the stored
  function, cleanupEvent(interval, boolean).

<p>  Interesting side-effect: You can now induce a cleanup manually,
  which will be useful for testing.

<li> cleanupEvent now has two parameters, passed in from slon config
  parameters:

<P>  interval - cleanup_interval (default '10 minutes')

<p>   This controls how quickly old events are trimmed out.  It used to
   be a hard-coded value.

<p>   Old events are trimmed out once the confirmations are aged by
   (cleanup_interval).

<p>   This then controls when the data in sl_log_1/sl_log_2 can be
   dropped.

<p>   Data in *those* tables is deleted when it is older than the
   earliest XID still captured in sl_event.

<p>  boolean - cleanup_deletelogs (default 'false')

<P>   This controls whether or not we DELETE data from sl_log_1/sl_log_2

<p>   By default, we now NEVER delete data from the log tables; we
   instead use TRUNCATE.

<li> We now consider initiating a log switch every time cleanupEvent()
  runs.

<P>  If the call to logswitch_finish() indicates that there was no log
  switch in progress, we initiate one.

<P>  This means that log switches will be initiated almost as often as
  possible.  That's a policy well worth debating :-).

<li> logswitch_finish() changes a fair bit...

<P>  It uses the same logic as in cleanupEvent() to determine if there
  are any *relevant* tuples left in sl_log_[whatever], rather than
  (potentially) scanning the table to see if there are any undeleted
  tuples left.

<li> At slon startup time, it logs (at SLON_CONFIG level) all of the
  parameter values.  Per <a href="http://www.slony.info/bugzilla/show_bug.cgi?id=21"> Bugzilla entry #21.</a>

  
<li> New slonik "CLONE PREPARE" and "CLONE FINISH" command to assist in
  creating duplicate nodes based on taking a copy of some existing
  subscriber node.

<li> We no longer use LISTEN/NOTIFY for events and confirmations, which
  eliminates the usage that has caused pg_listener bloat.  We instead
  poll against the event table.

<li> Various instances where slonik would use a default node ID of 1 have
  been changed to remove this.

<P>  Slonik scripts may need to be changed to indicate an EVENT NODE (or
  similar) after migration to v2.0 as a result.

<P>  The slonik commands involved:

<ul>
  <li> STORE NODE - EVENT NODE
  <li> DROP NODE - EVENT NODE
  <li> WAIT FOR EVENT - WAIT ON
  <li> FAILOVER - BACKUP NODE
  <li> EXECUTE SCRIPT - EVENT NODE
</ul>

<li> Fixed a problem where ACCEPT_SET would wait for the corresponding
  MOVE_SET or FAILOVER_SET to arrive while holding an exclusive lock
  on sl_config_lock, preventing the other remote worker to process
  that event.

<li> Bug #54 - quite a few Bash-isms in various scripts have been
  addressed so as to make the shell scripts more portable.

<li> Bug #18 - the function parameter for the logtrigger functions no
  longer requires any trailing v's

<P>  Add a test to "test1" to make sure this logic gets exercised.

<li> Created "start_slon.sh", an rc.d-style script for starting,
  stopping, and checking status of slon processes.

<P>  Integrated this into the regression tests, replacing previous
  logic for starting/stopping slons, so that this script can be
  considered carefully tested

<li> Bug #46 - incompatibility with PostgreSQL 8.4 addressed

<li> Use dollar quoting in stored functions

<li> Additional logging of the time spent running queries, broken out on
  a by-database basis

<li> Fixes to documentation of WAIT FOR EVENT

<li> Fix to bug #63 - cleanup thread had an imperative SELECT that needed
  to become part of an IF statement

<li> Enhancement - bug #61 - logshipper process should rescan the queue
  when it empties

<li> Note about "duct tape" tests:  There are many of these tests that
  reside in src/ducttape that reference features removed in v2.0.

<P>  We will eventually be replacing these with a more proper "test suite"
  so we're not remedying all the ducttape tests.
</ul>
----
Slony-I 2.0.0 second RC available
http://main.slony.info/downloads/2.0/source/slony1-2.0.0-rc2.tar.bz2
2008-09-24
Chris Browne

Now available is a second release candidate of version 2.0 of Slony-I,
fixing a number of issues found since the first release candidate.<BR>

<b>Differences from 2.0.0 RC1</b>
<BR>
<ul>
<li> Bug #54 - fixed various bash-isms </li>
<li> Bug #18 - function parameter for logtrigger no longer requires trailing "v"'s </li>
<li> Created start_slon.sh, an rc.d-style script to start, stop, and check status of a slon process, integrating its usage into regression tests </li>
<li> Bug #46 - incompatibility with PostgreSQL 8.4</li>
<li> Added an extended example of upgrading from one version of PostgreSQL to another </li>
<li> Use dollar quoting in stored functions </li>
<li> Added logging code that lists time spent running queries against different nodes to help when analyzing performance issues </li>
<li> A little more fixing-up of logging levels </li>
<li> Test suite uses non-zero lag_interval</li>
</ul>

---
Slony-I 1.2.15 available
http://main.slony.info/downloads/1.2/source/slony1-1.2.15.tar.bz2
2008-09-12
Chris Browne

Version 1.2.15 has been released.  Changes include:
<ul>
<li> Fix to STORE TRIGGER <p>- store trigger was running against all nodes
  upon subscription

  <P> <a href="http://www.slony.info/bugzilla/show_bug.cgi?id=56"> Bug #56 </a>

<li> Portability changes to some tools/ scripts, fixing some
  "bash-isms"

<li> Fix to switch statement in slonik.c; unknown how it broke

<li> Fix <a href=
  "http://bugs.slony.info/bugzilla/show_bug.cgi?id=52"> Bug #52 - 
memory leak</a>
</ul>

---
Slony-I 2.0.0 first RC available
http://main.slony.info/downloads/2.0/source/slony1-2.0.0-rc1.tar.bz2
2008-06-27
Chris Browne

Now available is a first release candidate of version 2.0 of Slony-I,
involving a large number of enhancements done over the last year or
so.<br>

<b>Differences from 1.2 stream</b>

<ul>
<li> Removal of TABLE ADD KEY

<li> It drops all support for databases prior to Postgres version 8.3.

<P> This is required because we now make use of new functionality in
Postgres, namely the trigger and rule support for session replication
role. As of now, every node (origin/subscriber/mixed) can be dumped with
pg_dump and result in a consistent snapshot of the database.

<li> Still need alterTableRestore() for the upgrade from 1.2.x to 2.0.
upgradeSchema() will restore the system catalog to a consistent
state and define+configure the new versions of the log and deny_access
triggers. 

<li> Fix EXECUTE SCRIPT so that it records the ev_seqno for WAIT FOR EVENT
and make sure all DDL is executed in session_replication_role "local"
on the origin as well as all subscribers. This will cause the slony
triggers to ignore all DML statements while user triggers follow the
regular configuration options for ENABLE [REPLICA/ALWAYS] or DISABLE.

<li> Let the logshipping files also switch to session_replication_role =
"replica" or "local" (for DDL).

<li> Sequence tracking becomes enormously less expensive; rather than
polling *ALL* sequence values for each and every SYNC, the slon
stores the last value, and only records entries in sl_seqlog when
the value changes from that last value.  If most sequences are
relatively inactive, they won't require entries in sl_seqlog very
often.

<li> Change to tools/slony1_dump.sh (used to generate log shipping dump);
  change quoting of "\\\backslashes\\\" to get rid of warning

<li> Cleanup thread revised to push most of the logic to evaluate which
  tables are to be vacuumed into a pair of stored functions.

<P>  This fairly massively simplifies the C code.

<li> Revised logging levels so that most of the interesting messages are
  spit out at SLON_CONFIG and SLON_INFO levels.  This can allow users
  to drop out the higher DEBUG levels and still have useful logs.

<li> Changed log selection query to be less affected by long running
  transaction.  This should help, in particular, the scenario where
  it takes a very long time to subscribe to a set.  In that situation,
  we have had the problem where applying the later SYNCs gets
  extremely costly as the query selecting logs wound up forced into a
  Seq Scan rather than an index scan.

<li> Removed all support for STORE/DROP TRIGGER commands. Users 
  should use the ALTER TABLE [ENABLE|DISABLE] TRIGGER functionality 
  available directly in Postgres from now on.

<li> Improve Wiki page generation script so that it has an option to add in
  a set of [[Category:Foo]] tags to allow automated categorization.

<li> Documented how to fix tables that presently use Slony-I-generated
  primary key candidates generated by TABLE ADD KEY

<li> Add some specific timestamps during the 2007 "DST rule change
  ambiguous time" (e.g. - during the period which, under former rules,
  was not DST, but which now is, due to the recent rule change).

<P>  Bill Moran ran into some problems with such dates; varying
  PostgreSQL versions returned somewhat varying results.  This wasn't
  a Slony-I problem; the data was indeed being replicated correctly.

<li> Made configure a bit smarter about automatically locating
  docbook2man-spec.pl on Debian, Fedora, BSD.

<li> Tests now generate |pipe|delimited|output| indicating a number of
  attributes of each test, including system/platform information,
  versions, and whether or not the test succeeded or failed.

<li> Revised functions that generate listen paths

<li> tools/configure-replication.sh script permits specifying a
  destination path for generated config files.  This enables using
  it within automated processes, and makes it possible to use it to
  generate Slonik scripts for tests in the "test bed," which has
  the further merit of making tools/configure-replication.sh a
  regularly-regression-tested tool.

<li> Fix to bug #15 - where long cluster name (>40 chars) leads to
  things breaking when an index name is created that contains
  the cluster name.

<ul>
  <li> Warn upon creating a long cluster name.
  <li> Give a useful exception that explains the cause rather
     than merely watching index creation fail.
</ul>

   See <a href="http://www.slony.info/bugzilla/show_bug.cgi?id=15"> Bug #15 </a>

<li> Fix for bug #19 - added a script to help the administrator
  search for any triggers on the database that is the source for
  a schema that is to be used to initialize a log shipping node.

<p>  The problem is that some/most/sometimes all triggers and rules
  are likely to need to be dropped from the log shipping node lest
  they interfere with replication.

<li> Elimination of custom "xxid" functions

<P>  PostgreSQL 8.3 introduces a set of "txid" functions and a
  "txid_snapshot" type, which eliminates the need for Slony-I to have
  its own C functions for doing XID comparisons.

<P>  Note that this affects the structure of sl_event, and leads to some
  changes in the coding of the regression tests.

<P>  This eliminates the src/xxid directory and contents

<li> All of the interesting cleanup work is now done in the stored
  function, cleanupEvent(interval, boolean).

<P>  Interesting side-effect: You can now induce a cleanup manually,
  which will be useful for testing.

<li> cleanupEvent now has two parameters, passed in from slon config
  parameters:

<P>  interval - cleanup_interval (default '10 minutes')

<P>   This controls how quickly old events are trimmed out.  It used to
   be a hard-coded value.

<P>   Old events are trimmed out once the confirmations are aged by
   (cleanup_interval).

<P>   This then controls when the data in sl_log_1/sl_log_2 can be
   dropped.

<P>   Data in <i>those</i> tables is deleted when it is older than the
   earliest XID still captured in sl_event.

<p>  boolean - cleanup_deletelogs (default 'false')

<P>   This controls whether or not we DELETE data from sl_log_1/sl_log_2

<P>   By default, we now NEVER delete data from the log tables; we
   instead use TRUNCATE.

<li> We now consider initiating a log switch every time cleanupEvent()
  runs.

<P>  If the call to logswitch_finish() indicates that there was no log
  switch in progress, we initiate one.

<P>  This means that log switches will be initiated almost as often as
  possible.  That's a policy well worth debating :-).

<li> logswitch_finish() changes a fair bit...

<P>  It uses the same logic as in cleanupEvent() to determine if there
  are any *relevant* tuples left in sl_log_[whatever], rather than
  (potentially) scanning the table to see if there are any undeleted
  tuples left.

<li> At slon startup time, it logs (at SLON_CONFIG level) all of the
parameter values.  Per <a
href="http://www.slony.info/bugzilla/show_bug.cgi?id=21"> Bugzilla
entry #21.</a>

<li> New slonik "CLONE PREPARE" and "CLONE FINISH" command to assist in
  creating duplicate nodes based on taking a copy of some existing
  subscriber node.

<li> We no longer use LISTEN/NOTIFY for events and confirmations, which
  eliminates the usage that has caused pg_listener bloat.  We instead
  poll against the event table.

<li> Various instances where slonik would use a default node ID of 1 have
  been changed to remove this.

<P>  Slonik scripts may need to be changed to indicate an EVENT NODE (or
  similar) after migration to v2.0 as a result.

<P>  The slonik commands involved:

<ul>
  <li> STORE NODE - EVENT NODE
  <li> DROP NODE - EVENT NODE
  <li> WAIT FOR EVENT - WAIT ON
  <li> FAILOVER - BACKUP NODE
  <li> EXECUTE SCRIPT - EVENT NODE
</ul>
<li> Fixed a problem where ACCEPT_SET would wait for the corresponding
  MOVE_SET or FAILOVER_SET to arrive while holding an exclusive lock
  on sl_config_lock, preventing the other remote worker to process
  that event.
</ul>
---
Slony-I 1.2.14 available
http://main.slony.info/downloads/1.2/source/slony1-1.2.14.tar.bz2
2008-05-16
Chris Browne

Version 1.2.14 has been released.  Changes include:
<ul>
<li> Fix typo in configure-replication.sh (missing CR)

<li> Per <a href="http://www.slony.info/bugzilla/show_bug.cgi?id=35">bug #35,</a>
  search the Slony share dir for scripts before falling back to the PG
  share dir on 8.0+

 <p> This has resulted in quite a lot of discussion on bug #35; we
 <i>need</i> agreement that this change is an apropos way to go...
  
<li> Change test framework to write out the test name into
  $TEMPDIR/TestName

<li> Patch that seems to resolve a race condition with
  ACCEPT_SET

<li> Fix bug #49 - mishandling by slony_logshipper of quotes and
  backslashes.

<li> Fix bug #50 - slony_logshipper had a variable access <i>after</i>
  memory was freed

</ul>
---
Docs for 1.2.13 updated to include png, man pages
http://main.slony.info/downloads/1.2/source/slony1-1.2.13-docs.tar.bz2
2008-02-29
Chris Browne

Vivek Khera observed that the documentation tarball did not include
.png files or man pages; added this in, and rebuilt the tarball.

<P>There is no change to the source code tarball.
---
Slony-I 1.2.13 available
http://main.slony.info/downloads/1.2/source/slony1-1.2.13.tar.bz2
2008-02-09
Chris Browne

<ul>
<li> Fixed problem with compatibility with PostgreSQL 8.3; function
  typenameTypeId() has 3 arguments as of 8.3.

  <p> This now allows Slony-I to work with the PostgreSQL 8.3.0 release.

<li> Added in logic to ensure that max # of SYNCs grouped together is
  actually constrained by config parameter sync_group_maxsize.

<li> Fix to show_slony_configuration - point to proper directory where
  slon/slonik are actually installed.

<li> Fix to slonik Makefile + slonik.c - Change slonik build to query
  Postgres for the share directory at runtime - per Dave Page

<li> Removed spurious NOTIFY on "_%s_Confirm"; this is no longer needed
  in the 1.2 branch, as there is no LISTEN on this notification.
  Noted in <a href="http://www.slony.info/bugzilla/show_bug.cgi?id=32"> bug #32</a>
</ul>
---
Slony-I Bugzilla available
http://bugs.slony.info/bugzilla/
2007-11-13
Christopher Browne

<P> Many thanks to Command Prompt staff for installing and configuring
a <a href="http://www.bugzilla.org/"> Bugzilla</a> instance for use in
tracking Slony-I bugs and feature requests.

<P> Feature and bug lists will be migrating into this over the next
little while...

---
Slony-I 1.2.12 available
http://slony.info/downloads/1.2/source/slony1-1.2.12.tar.bz2
2007-11-12
Christopher Browne

<P> Version 1.2.12 is now released
<ul>
<li>Fixed problem with DDL SCRIPT parser where C-style comments were
  not being processed properly

<li>Added stored functions and documentation for adding empty tables
  (notably *partitions*) to replication.  Note these functions
  do no work when not specifically requested.

  CAVEAT:  This functionality may not work as expected on versions
  of PostgreSQL earlier than 8.1.  Mind you, partitioning tends
  to function pretty poorly in earlier versions of PostgreSQL as
  there were substantial enhancements in 8.1 and following versions.

<li>Added a fairly substantial partitioning test to exercise the
  new stored functions above.

<li>Backport "listen path" generator function from CVS HEAD (2.0) to
  1.2 branch.

<li>Fixed a problem with "EXECUTE SCRIPT" (introduced in remote_worker.c
  version 1.124.2.13) where moving the relevant code into a subroutine
  at the end led to losing the "BEGIN; SET TRANSACTION ISOLATION LEVEL
  SERIALIZABLE;" query that needs to be the first thing run...

<li>Fixing the archive sequence generations (in log shipping).  All
  non-SYNC events must start the local transaction before creating the
  archive as well, so that the lock on the archive counter table
  serializes archive creation.

<li>Fixed logging done in local_listener.c - various places, there was
  no '\n' in some cases, which would lead to entries being folded
  together.

<li>Fix launch_slons.sh - was not stripping quotes from PID file name

<li>Error handling for "ERROR: could not serialize access due to
  concurrent update"

  <P> If this error is encountered when starting processing of
  sl_archive_counter, then two threads are fighting over access to
  this counter, and at least one has just failed.

  <P> Rather than waiting, we ask to restart the node immediately.

<li> Fixes to slonik_build_env script - it wasn't properly handling
  cases where there was just 1 table or 1 sequence, and had a
  problem with the -schema option - thanks, Bernd Helmle

<li> Don't bother building slony_logshipper on Win32 as it doesn't work
  there at this point.

<li> If slonik connects as other than a superuser, then generate error
  message indicating this to the user.
</ul>
---
Slony-I 1.2.11 released
http://slony.info/downloads/1.2/source/slony1-1.2.11.tar.bz2
2007-08-28
Christopher Browne

We are pleased to announce general availability of Slony-I 1.2.11.

<P> Fixes are the following:
<ul>
<li> Add in tools/mkservice scripts previously added to CVS HEAD

<li> During subscription, do UPDATE to pg_class.relhasindex *after* the
  TRUNCATE because, in 8.2+, TRUNCATE resets this attribute

<li> Fixed a problem with the setsync tracking with Log Shipping in cases
  where slon does an internal restart (thereby rereading the
  pset.ssy_seqno) and ignoring non-SYNC events because those don't
  change the sl_setsync table.

<li> More explicit type casting of text objects for compatibility with
  PostgreSQL 8.3

<li> Fixed problem with DDL SCRIPT statement parser: it wasn't 'quoting'
  semicolons inside parentheses (this notably occurs in CREATE RULE).

<li> Fixed problem with DDL SCRIPT statement submission; it was
  interpreting the statement as a format string, which would have
  ill effects in the presence of things that are interpreted such
  as format strings (%d, %f, %s) and \backslashed things like \\, \n.

<li> Further DDL Script issue: non-terminated statement at the end
  (e.g. - without trailing semicolon ";") would get omitted.

<li> Typo fix: when trying to disable a node, the logs would report
  "enableNode" rather than "disableNode".  Fixed.

<li> Add usage/version options to help output in slon.

<li> Fix archive logging for replicated sequences.

<li> Fix to log shipping - added another table, sl_archive_counter where
  the log writing slon simply tracks when it wrote the last offline
  archive file and maintains a counter. This counter is now tracked in
  the offline replica and must increment gap free.

<li> Change the filenames of archive logs to be based on internal archive
  tracking number.  This makes it easy for the mechanism applying
  archives to figure out what needs to be applied next - just look in
  sl_archive_tracking.

<li> Fix log shipping test to accomodate the new tracking scheme, and
  update documentation to describe this better.  
</ul>
---
Generating RPMS for Slony-I
http://slony.info/
2007-06-28
Devrim Gunduz

RPM "spec" files are a part of the Slony-I build; if you require RPMs
for your flavour of RPM-based distribution, try building Slony-I thus:

<pre>
./configure
make rpm
</pre>

For systems reasonably similar to Fedora and RHAS, this will generate
.rpm files that will be compatible with your system.
---
Turkish Documentation for Slony-I
http://www.enderunix.org/docs/postgresql/
2007-06-27
Ismail Yenigul

Ismail Yenigul has made available documentation written in Turkish in
<a href=
"http://www.enderunix.org/docs/postgresql/slony_replication.odt">
StarOffice Writer format </a> or <a href=
"http://www.enderunix.org/docs/postgresql/slony_replication.pdf"> PDF
</a>.
---
Slony-I 1.2.10 Windows Binaries Available
http://developer.pgadmin.org/~hiroshi/Slony-I/
2007-06-27
Hiroshi Saito

Slony-I 1.2.10 has been built for Windows; binaries are available <a
href="http://developer.pgadmin.org/~hiroshi/Slony-I/"> here. </a>
---
Slony-I 1.2.10 Released
http://lists.slony.info/downloads/1.2/source/slony1-1.2.10.tar.bz2
2007-06-26
Chris Browne

We are pleased to announce the release of Slony-I version 1.2.10.
Sources as well as pre-built documentation is available in the
download area; users of RPM-based systems and Windows will likely see
suitable packages soon.
---
Slony-I 1.2.10 pre-release tarball #2 uploaded
http://lists.slony.info/downloads/1.2/source/slony1-1.2.10-pre2.tar.bz2
2007-06-21
Chris Browne

I have uploaded a tarball for 1.2.10 based on the fixes that have come
in this week to <a href=
"http://main.slony.info/documentation/logshipping.html"> log shipping
</a>.

<P> I have run tests of this build on Debian/Unstable on the IA-32
architecture against each of PostgreSQL 7.4, 8.0, 8.1, 8.2, and a
recent copy of CVS HEAD (e.g. - 8.3).

<P> Please <i>do not</i> release binaries based on this tarball; that
could lead to the regrettable situation of people downloading
something that isn't the true final release of 1.2.10.  The license
permits such things, but <i>please</i> wait until we call this final...
---
Logshipping issue solved
http://lists.slony.info/pipermail/slony1-commit/2007-June/001827.html
2007-06-19
Chris Browne

Jan's Patch of June 19th evidently resolves the log shipping problems
to the point that it survives the "torture test."

<P> Retesting ongoes...
---
Version 1.2.10 - log shipping problem to solve
http://lists.slony.info/pipermail/slony1-bugs/2007-June/000017.html
2007-06-12
Chris Browne

Alas, I found a problem with log shipping.  I wrote a test where I
surrounded a DDL_SCRIPT event with a series of STORE_TRIGGER events;
this led to a fairly wacky set of SYNC ID numbers getting generated.
(See the "testlogship" test in the tests area for details on the
test.)

<P> Well, comprehensively breaking it hopefully leads to a
comprehensive fix...

<P> In more positive news, the test called "testmultiplemoves" seems
to be working well, so there's more testing taking place than ever...
---
Version 1.2.10 testing still under way
http://main.slony.info/downloads/1.2
2007-06-11
Chris Browne

I have done further updates to documentation after discovering a
problem with compatibility of UPDATE FUNCTIONS with versions 8.1.0
thru 8.1.3.  Alas, you won't have much success running UPDATE
FUNCTIONS on those versions.

<P> Jan Wieck has made various casting changes throughout the code to
address a change in how version 8.3 handles the automatic casting of
string values.  This has resulted in my needing to run the latest CVS
thru a comprehensive set of cross-PG-version tests, again, because
there is a potential for this to break compatibility with elder
versions of PostgreSQL.  (Hopefully not, but we'd better test, hadn't
we...)
---
Sample of configuring Slony-I on Windows
http://winpg.jp/~saito/Slony-I-sample/
2007-05-02
Hiroshi Saito
Here are <a href="http://winpg.jp/~saito/Slony-I-sample/">sample configuration files</a> for the usage of Slony-I 1.2.9 on Windows.
---
Slony-I Release - 1.2.9
http://main.slony.info/downloads/1.2
2007-03-22
Chris Browne
We are pleased to announce the release of version 1.2.9, which may be
found <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.9.tar.bz2">here</a>.  
There is also a <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.9-docs.tar.bz2">Documentation tarball </a>.

<P> This release fixes several problems that were found in the 1.2 stream:
<ul>
<li> Reverted change that tried to support elderly apache rotatelogs

<li> Added a patch file to apply if you need to support elderly apache rotatelogs (tools/altperl/old-apache-rotatelogs.patch)

<li> Bug in UPDATE FUNCTIONS - wrong quoting in plpgsql function

<li> Add a regression test that runs UPDATE FUNCTIONS to ensure that it at least has no syntax errors
</ul>
---
Slony-I Release - 1.1.9
http://main.slony.info/downloads/1.1
2007-03-22
Chris Browne
We are pleased to announce the release of version 1.1.9, which may be
found <a href="http://main.slony.info/downloads/1.1/source/slony1-1.1.9.tar.bz2">here</a>.  

<P> This release fixes several problems that were found in the 1.1 stream:
<ul>
<li> Missed adding v81 SQL base files to CVS

<li> Reverted change that tried to support elderly apache rotatelogs

<li> Added a patch file to apply if you need to support elderly apache rotatelogs (tools/altperl/old-apache-rotatelogs.patch)
</ul>
---
Slony-I Release - 1.2.8
http://main.slony.info/downloads/1.2
2007-03-16
Chris Browne
We are pleased to announce the release of version 1.2.8, which may be
found <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.8.tar.bz2">here</a>.  
There is also a <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.8-docs.tar.bz2">Documentation tarball </a>.

<P> This release fixes several problems that were found in the 1.2 stream:
<ul>
<li> Change to rotatelogs configuration to support older versions of Apache
log rotator

<li> Fix to altperl "execute script" script to pass the filename properly

<li> Fix to <tt>src/backend/slony1_funcs.v80.sql</tt> - comment on the right function in v8.0

<li> Fix to <tt>src/slonik/slonik.c</tt> - it wasn't pulling in the right version of slony1_funcs.?.sql in some cases (notably with versions 8.1 and 8.2)

<li> Updated docs on creating releases to describe the version mismatch problem found above in <tt>slonik.c</tt>
</ul>
---
Slony-I Release - 1.1.8
http://main.slony.info/downloads/1.1
2007-03-16
Chris Browne
We are pleased to announce the release of version 1.1.8, which may be
found <a href="http://main.slony.info/downloads/1.1/source/slony1-1.1.8.tar.bz2">here</a>.  

<P> This release fixes several problems that were found in the 1.1 stream:
<ul>
<li> Change to rotatelogs configuration to support older versions of Apache
log rotator

<li> Fix to altperl "execute script" script to pass the filename properly

<li> Fix to xxid Makefile: in the 1.1 branch, xxid.v73.sql is still in
use, and should be copied to generate the other versions.

<li> Fix to <tt>src/backend/slony1_funcs.v80.sql</tt> - comment on the right function in v8.0

<li> Fix to <tt>src/slonik/slonik.c</tt> - it wasn't pulling in the right version of slony1_funcs.?.sql in some cases (notably with versions 8.1 and 8.2)

</ul>
---
Slony-I Release - 1.2.7
http://main.slony.info/downloads/1.2
2007-03-07
Chris Browne
We are pleased to announce the release of version 1.2.7, which may be
found <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.7.tar.bz2">here</a>.  
There is also a <a href="http://main.slony.info/downloads/1.2/source/slony1-1.2.7-docs.tar.bz2">Documentation tarball </a>.

<P> This release fixes several problems that were found in the 1.2 stream:
<ul>
<li> Add remote_listen_timeout parameter to slon.conf

<p> This addresses the problem where a slon times out when accessing
sl_event if a node has been out of commission for a long time (several
days)

<li> Resolve bug #1623

<p> In this bug, big "action lists" that need to get compressed could cause
a logging printf to blow up.  Changed the logging level so that detail
is only shown at level 4, which won't bite people by default.

<li> UNINSTALL NODE failures now show node # in slonik error messages

<P> If a user ran several UNINSTALL NODE requests in a single slonik
script, and one of them broke, you'd have no ready way to tell which
node this failed on.  Added code to report the node # where it failed.

<li> Added test to test1 for function generate_sync_event() and make_function_strict

<li> Added "v81" files (for slony1_base.v81.sql, slony1_funcs.v81.sql,
xxid.v81.sql), necessary to support 8.1 "ALTER FUNCTION ... STRICT";

<li> Fixed quoting problem in generate_sync_event()

<li> Added functionality to UPDATE FUNCTIONS to make xxidin() function
STRICT; the absence of this caused postmaster to fall over when
processing MOVE SET event in PG v8.2

<li> Added documentation of an issue surrounding NULLABLE columns to the
log analysis chapter of the admin guide and to the UPGRADING docs.

<li> When you run MOVE SET, this populates sl_setsync for the moved set
  even on nodes that are not subscribed.  If, subsequent to doing this, 
  you attempt a SUBSCRIBE SET for a formerly-unsubscribed node, the
  subscription will fail right at the end when the slon tries to insert a
  new value to sl_setsync.

<P>   The fix: DELETE from sl_setsync immediately before the INSERT.  This
  will silently blow away any 'offending' sl_setsync row.

<p>  (As observed by Afilias staff...)

<li> Log shipping fix - storage of sl_setsync_offline call had a wrong
  printf type; change from %d to %s
</ul>
---
Slony-I Release - 1.1.7
http://main.slony.info/downloads/1.1
2007-03-07
Chris Browne
We are pleased to announce the release of version 1.1.7, which may be
found <a href="http://main.slony.info/downloads/1.1/source/slony1-1.1.7.tar.bz2">here</a>.  
It fixes several problems that were found in the 1.2 stream that were readily back-ported to 1.1:
<ul>
<li>Add remote_listen_timeout parameter to <tt>slon.conf</tt>

<p> This addresses the problem where a slon times out when accessing
sl_event if a node has been out of commission for a long time (several
days)

<li> Add node numbers to error reports in slonik

<p> If portions of UNINSTALL NODE break, report in the error message which node
it was working on.  That way the gentle user gets an indication as to 
which node 'broke' if the slonik script contained multiple such
requests.

<li> Applied bug fix for #1538

<p> If cluster has only one node, then remove all events up to the last
SYNC.  That allows the cleanup loop to clear out sl_log_{1/2}.
Otherwise, the log tables will forever bloat until you add a second
node...

<li> Added test to test1 for function generate_sync_event() and make_function_strict

<li> Added "v81" files (for slony1_base.v81.sql, slony1_funcs.v81.sql,
xxid.v81.sql), necessary to support 8.1 "ALTER FUNCTION ... STRICT";

<li> Fixed quoting problem in generate_sync_event()

<li> Added functionality to UPDATE FUNCTIONS to make xxidin() function
STRICT; the absence of this caused postmaster to fall over when
processing MOVE SET event in PG v8.2 (not to say that Slony-I 1.1 now
*supports* 8.2; it does not)

<li> When you run MOVE SET, this populates sl_setsync for the moved set
  even on nodes that are not subscribed.  If, subsequent to doing this, 
  you attempt a SUBSCRIBE SET for a formerly-unsubscribed node, the
  subscription will fail right at the end when the slon tries to insert a
  new value to sl_setsync.

<p>  The fix: DELETE from sl_setsync immediately before the INSERT.  This
  will silently blow away any 'offending' sl_setsync row.

<P>  (As observed by Afilias staff...)

<li> Log shipping fix - storage of sl_setsync_offline call had a wrong
  printf type; change from %d to %s
</ul>
---
Slony-I New Web Site!
http://main.slony.info
2007-03-02
Chris Browne
We are pleased to announce the release of the new Slony-I web site at <tt>main.slony.info</tt>.
---
Slony-I New CVS Site!
http://main.slony.info/cvs.html
2007-01-20
<a href="mailto:cbbrowne@acm.org">Chris Browne</a>
The Slony-I project is now making active use of CVS repositories at <tt>cvs.slony.info</tt>; this replaces the former
CVS repositories at gBorg.  We thank the gBorg operators for their support over the last few years, and Command Prompt for their provision of hardware, administrative, and hosting services for <tt>cvs.slony.info</tt>.
---
